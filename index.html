<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Molina - Cerveza Artesanal</title>

    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="assets/small_logo.jpg">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Source+Sans+Pro:wght@300;400;600&display=swap" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container header-content">
            <img src="assets/small_logo.jpg" alt="Molina Cerveza Artesanal" class="logo-img">
            <div style="flex: 1;">
                <h1 class="logo">Molina - Cerveza Artesanal</h1>
                <p class="subtitle">Registro de Cervecer√≠a</p>
            </div>

            <!-- Status Indicators -->
            <div class="status-indicators">
                <div class="status-item online-status" id="online-status">
                    <span class="status-dot"></span>
                    <span class="status-text">Online</span>
                </div>
                <div class="status-item sync-status" id="sync-status">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
                    </svg>
                    <span class="status-text" id="last-sync-text">Cargando...</span>
                </div>
            </div>

            <button onclick="logout()" class="logout-btn" title="Cerrar sesi√≥n">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                    <polyline points="16 17 21 12 16 7"/>
                    <line x1="21" y1="12" x2="9" y2="12"/>
                </svg>
                <span>Cerrar Sesi√≥n</span>
            </button>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="container">
            <!-- Reportes Group -->
            <div class="nav-group">
                <button class="nav-group-btn">Reportes ‚ñæ</button>
                <div class="nav-dropdown">
                    <button class="nav-btn active" data-section="dashboard">Tablero</button>
                    <button class="nav-btn" data-section="reports">Estado PyG</button>
                </div>
            </div>

            <!-- Ingresar Registros Group -->
            <div class="nav-group">
                <button class="nav-group-btn">Ingresar Registros ‚ñæ</button>
                <div class="nav-dropdown">
                    <button class="nav-btn" data-section="production">Producci√≥n</button>
                    <button class="nav-btn" data-section="transactions">Transacciones</button>
                    <button class="nav-btn" data-section="sales">Ventas</button>
                </div>
            </div>

            <!-- Ajustes Group -->
            <div class="nav-group">
                <button class="nav-group-btn">Ajustes ‚ñæ</button>
                <div class="nav-dropdown">
                    <button class="nav-btn" data-section="data">Datos</button>
                    <button class="nav-btn" data-section="config">Par√°metros</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container">

        <!-- Back Button (hidden on home) -->
        <button id="back-btn" class="back-btn" onclick="goToHome()" style="display: none;">
            ‚Üê Volver al Men√∫ Principal
        </button>

        <!-- Home Section -->
        <section id="home" class="section active">
            <h2>Men√∫ Principal</h2>

            <div class="menu-grid">
                <!-- Reportes Card -->
                <div class="menu-card" onclick="showMenuGroup('reportes')">
                    <div class="menu-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 3v18h18"/>
                            <path d="M18 17V9"/>
                            <path d="M13 17V5"/>
                            <path d="M8 17v-3"/>
                        </svg>
                    </div>
                    <div class="menu-card-content">
                        <h3>Reportes</h3>
                        <p>Tablero de control y estado de p√©rdidas y ganancias</p>
                    </div>
                    <div class="menu-card-arrow">‚Üí</div>
                </div>

                <!-- Registros Card -->
                <div class="menu-card" onclick="showMenuGroup('registros')">
                    <div class="menu-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <path d="M14 2v6h6"/>
                            <path d="M16 13H8"/>
                            <path d="M16 17H8"/>
                            <path d="M10 9H8"/>
                        </svg>
                    </div>
                    <div class="menu-card-content">
                        <h3>Registros</h3>
                        <p>Producci√≥n, transacciones y ventas</p>
                    </div>
                    <div class="menu-card-arrow">‚Üí</div>
                </div>

                <!-- Ajustes Card -->
                <div class="menu-card" onclick="showMenuGroup('ajustes')">
                    <div class="menu-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="3"/>
                            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                        </svg>
                    </div>
                    <div class="menu-card-content">
                        <h3>Ajustes</h3>
                        <p>Gesti√≥n de datos y par√°metros</p>
                    </div>
                    <div class="menu-card-arrow">‚Üí</div>
                </div>
            </div>
        </section>

        <!-- Reportes Group Section -->
        <section id="reportes-menu" class="section">
            <h2>Reportes</h2>
            <div class="menu-grid">
                <div class="menu-card submenu-card" data-section="dashboard">
                    <div class="menu-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2"/>
                            <path d="M3 9h18"/>
                            <path d="M9 21V9"/>
                        </svg>
                    </div>
                    <div class="menu-card-content">
                        <h3>Tablero</h3>
                        <p>KPIs y gr√°ficas del negocio</p>
                    </div>
                    <div class="menu-card-arrow">‚Üí</div>
                </div>
                <div class="menu-card submenu-card" data-section="reports">
                    <div class="menu-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <path d="M14 2v6h6"/>
                        </svg>
                    </div>
                    <div class="menu-card-content">
                        <h3>Estado PyG</h3>
                        <p>P√©rdidas y ganancias detallado</p>
                    </div>
                    <div class="menu-card-arrow">‚Üí</div>
                </div>
            </div>
        </section>

        <!-- Registros Group Section -->
        <section id="registros-menu" class="section">
            <h2>Ingresar Registros</h2>
            <div class="menu-grid">
                <div class="menu-card submenu-card" data-section="production">
                    <div class="menu-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 2h6"/>
                            <path d="M9 2v2c0 1.5-1 2-2 2H6v14a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V6h-1c-1 0-2-.5-2-2V2"/>
                            <path d="M6 10h12"/>
                        </svg>
                    </div>
                    <div class="menu-card-content">
                        <h3>Producci√≥n</h3>
                        <p>Lotes de producci√≥n</p>
                    </div>
                    <div class="menu-card-arrow">‚Üí</div>
                </div>
                <div class="menu-card submenu-card" data-section="transactions">
                    <div class="menu-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2v20"/>
                            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                        </svg>
                    </div>
                    <div class="menu-card-content">
                        <h3>Transacciones</h3>
                        <p>Ingresos y gastos</p>
                    </div>
                    <div class="menu-card-arrow">‚Üí</div>
                </div>
                <div class="menu-card submenu-card" data-section="sales">
                    <div class="menu-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="9" cy="21" r="1"/>
                            <circle cx="20" cy="21" r="1"/>
                            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                        </svg>
                    </div>
                    <div class="menu-card-content">
                        <h3>Ventas</h3>
                        <p>Registro de ventas</p>
                    </div>
                    <div class="menu-card-arrow">‚Üí</div>
                </div>
            </div>
        </section>

        <!-- Ajustes Group Section -->
        <section id="ajustes-menu" class="section">
            <h2>Ajustes</h2>
            <div class="menu-grid">
                <div class="menu-card submenu-card" data-section="data">
                    <div class="menu-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <ellipse cx="12" cy="5" rx="9" ry="3"/>
                            <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/>
                            <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/>
                        </svg>
                    </div>
                    <div class="menu-card-content">
                        <h3>Datos</h3>
                        <p>Importar, exportar y gestionar</p>
                    </div>
                    <div class="menu-card-arrow">‚Üí</div>
                </div>
                <div class="menu-card submenu-card" data-section="config">
                    <div class="menu-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="4" y1="21" x2="4" y2="14"/>
                            <line x1="4" y1="10" x2="4" y2="3"/>
                            <line x1="12" y1="21" x2="12" y2="12"/>
                            <line x1="12" y1="8" x2="12" y2="3"/>
                            <line x1="20" y1="21" x2="20" y2="16"/>
                            <line x1="20" y1="12" x2="20" y2="3"/>
                            <line x1="1" y1="14" x2="7" y2="14"/>
                            <line x1="9" y1="8" x2="15" y2="8"/>
                            <line x1="17" y1="16" x2="23" y2="16"/>
                        </svg>
                    </div>
                    <div class="menu-card-content">
                        <h3>Par√°metros</h3>
                        <p>Configuraci√≥n y sincronizaci√≥n</p>
                    </div>
                    <div class="menu-card-arrow">‚Üí</div>
                </div>
            </div>
        </section>

        <!-- Dashboard Section -->
        <section id="dashboard" class="section">
            <h2>Tablero de Control</h2>

            <!-- Period Filter -->
            <div class="card filter-card">
                <h3>Filtrar Periodo</h3>
                <div class="filter-controls">
                    <label>
                        Mes:
                        <select id="filter-month">
                            <option value="">Todos</option>
                            <option value="1">Enero</option>
                            <option value="2">Febrero</option>
                            <option value="3">Marzo</option>
                            <option value="4">Abril</option>
                            <option value="5">Mayo</option>
                            <option value="6">Junio</option>
                            <option value="7">Julio</option>
                            <option value="8">Agosto</option>
                            <option value="9">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </label>
                    <label>
                        A√±o:
                        <select id="filter-year">
                            <!-- Populated dynamically -->
                        </select>
                    </label>
                    <button class="primary" onclick="updateDashboard()">Actualizar</button>
                </div>
            </div>

            <!-- KPI Cards -->
            <div class="kpi-grid">
                <div class="card kpi-card">
                    <h3>Ingresos Brutos</h3>
                    <p class="kpi-value" id="kpi-revenue">$0.00 MXN</p>
                </div>
                <div class="card kpi-card">
                    <h3>Gastos Totales</h3>
                    <p class="kpi-value" id="kpi-expenses">$0.00 MXN</p>
                </div>
                <div class="card kpi-card">
                    <h3>Ganancia o P√©rdida Neta</h3>
                    <p class="kpi-value" id="kpi-profit">$0.00 MXN</p>
                </div>
                <div class="card kpi-card">
                    <h3>Chelas Totales Producidas</h3>
                    <p class="kpi-value" id="kpi-pints">0</p>
                </div>
            </div>

            <!-- Combined Pricing Card -->
            <div class="card cost-per-beer-card">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; align-items: center;">
                    <div style="text-align: center; padding: 1rem; border-right: 2px solid rgba(255,255,255,0.2);">
                        <h2 style="font-size: 1.5rem; margin-bottom: 1rem;">Costo Por Chela (CPC)</h2>
                        <p class="cost-per-beer-result" id="cost-per-beer">$0.00 MXN</p>
                    </div>
                    <div style="text-align: center; padding: 1rem;">
                        <h2 style="font-size: 1.5rem; margin-bottom: 1rem;">Precio Sugerido</h2>
                        <p class="cost-per-beer-result" id="suggested-price">$0.00 MXN</p>
                        <p class="subtitle" id="profit-margin-label" style="font-size: 0.85rem; margin-top: 0.5rem;">Con margen de 3x</p>
                    </div>
                </div>
                <p class="subtitle" style="margin-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 1rem;">Basado en el periodo seleccionado</p>
            </div>

            <!-- Charts -->
            <div class="charts-grid">
                <div class="card chart-card">
                    <h3>Ingresos vs Gastos Mensuales</h3>
                    <canvas id="revenueExpensesChart"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Desglose de Gastos</h3>
                    <canvas id="expenseBreakdownChart"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Producci√≥n Mensual (Chelas)</h3>
                    <canvas id="productionChart"></canvas>
                </div>
                <div class="card chart-card">
                    <h3>Tendencia de Costo por Chela</h3>
                    <canvas id="cppTrendChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Production Section -->
        <section id="production" class="section">
            <h2>Registro de Producci√≥n</h2>

            <div class="card form-card">
                <h3>Nuevo Lote de Producci√≥n</h3>
                <form id="production-form">
                    <div class="form-group">
                        <label for="prod-date">Fecha:</label>
                        <input type="date" id="prod-date" required>
                    </div>
                    <div class="form-group">
                        <label for="prod-beer-name">Nombre de la Chela:</label>
                        <input type="text" id="prod-beer-name" required>
                    </div>
                    <div class="form-group">
                        <label for="prod-volume">Volumen Producido (chelas):</label>
                        <input type="number" id="prod-volume" step="0.1" required>
                    </div>
                    <div class="form-group">
                        <label for="prod-hours">Horas Laborales:</label>
                        <input type="number" id="prod-hours" step="0.5" required>
                    </div>
                    <div class="form-group">
                        <label for="prod-ingredients">Consumo de Ingredientes (MXN):</label>
                        <input type="number" id="prod-ingredients" step="0.01" required>
                    </div>
                    <button type="submit" class="primary">Registrar Lote</button>
                </form>
            </div>

            <div class="card table-card">
                <h3>Historial de Producci√≥n</h3>
                <table id="production-table">
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Chela</th>
                            <th>Chelas</th>
                            <th>Horas</th>
                            <th>Costo Ingredientes</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="production-tbody">
                        <!-- Populated dynamically -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Transactions Section -->
        <section id="transactions" class="section">
            <h2>Registro de Transacciones</h2>

            <div class="card form-card">
                <h3>Nueva Transacci√≥n</h3>
                <form id="transaction-form">
                    <div class="form-group">
                        <label for="trx-date">Fecha:</label>
                        <input type="date" id="trx-date" required>
                    </div>
                    <div class="form-group">
                        <label for="trx-description">Descripci√≥n:</label>
                        <input type="text" id="trx-description" required>
                    </div>
                    <div class="form-group">
                        <label for="trx-amount">Monto (MXN):</label>
                        <input type="number" id="trx-amount" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="trx-type">Tipo:</label>
                        <select id="trx-type" required>
                            <option value="income">Ingreso</option>
                            <option value="expense">Gasto</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="trx-category">Categor√≠a:</label>
                        <select id="trx-category" required>
                            <option value="">Seleccionar...</option>
                            <!-- Income Categories -->
                            <optgroup label="Ingresos">
                                <option value="ventas">Ingreso por Ventas</option>
                                <option value="otros-ingresos">Otros Ingresos</option>
                            </optgroup>
                            <!-- Expense Categories -->
                            <optgroup label="Gastos">
                                <option value="ingredientes">Compra de Ingrediente Variable</option>
                                <option value="renta">Renta</option>
                                <option value="salario">Salario</option>
                                <option value="servicios">Servicios (Luz, Agua, etc.)</option>
                                <option value="marketing">Marketing</option>
                                <option value="mantenimiento">Mantenimiento</option>
                                <option value="general">Gasto General</option>
                            </optgroup>
                        </select>
                    </div>
                    <button type="submit" class="primary">Registrar Transacci√≥n</button>
                </form>
            </div>

            <div class="card table-card">
                <h3>Historial de Transacciones</h3>
                <table id="transaction-table">
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Descripci√≥n</th>
                            <th>Tipo</th>
                            <th>Categor√≠a</th>
                            <th>Monto</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="transaction-tbody">
                        <!-- Populated dynamically -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Sales Section -->
        <section id="sales" class="section">
            <h2>Registro de Ventas</h2>

            <div class="card form-card">
                <h3>Nuevo Registro de Ventas</h3>
                <form id="sales-form">
                    <div class="form-group">
                        <label for="sales-date">Fecha:</label>
                        <input type="date" id="sales-date" required>
                    </div>
                    <div class="form-group">
                        <label for="sales-revenue">Ingreso Total (MXN):</label>
                        <input type="number" id="sales-revenue" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="sales-volume">Volumen Vendido (chelas):</label>
                        <input type="number" id="sales-volume" step="0.1" required>
                    </div>
                    <button type="submit" class="primary">Registrar Ventas</button>
                </form>
            </div>

            <div class="card table-card">
                <h3>Historial de Ventas</h3>
                <table id="sales-table">
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Ingreso Total</th>
                            <th>Volumen Vendido</th>
                            <th>Precio Promedio/Chela</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="sales-tbody">
                        <!-- Populated dynamically -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Reports Section -->
        <section id="reports" class="section">
            <h2>Estado de P√©rdidas y Ganancias (PyG)</h2>

            <div class="card filter-card">
                <h3>Filtrar Reporte</h3>
                <div class="filter-controls">
                    <label>
                        Mes:
                        <select id="report-month">
                            <option value="">Todos</option>
                            <option value="1">Enero</option>
                            <option value="2">Febrero</option>
                            <option value="3">Marzo</option>
                            <option value="4">Abril</option>
                            <option value="5">Mayo</option>
                            <option value="6">Junio</option>
                            <option value="7">Julio</option>
                            <option value="8">Agosto</option>
                            <option value="9">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </label>
                    <label>
                        A√±o:
                        <select id="report-year">
                            <!-- Populated dynamically -->
                        </select>
                    </label>
                    <button class="primary" onclick="generateReport()">Generar Reporte</button>
                </div>
            </div>

            <div class="card report-card">
                <div id="report-content">
                    <p class="text-center">Seleccione un periodo y haga clic en "Generar Reporte"</p>
                </div>
            </div>
        </section>

        <!-- Data Management Section -->
        <section id="data" class="section">
            <h2>Gesti√≥n de Datos</h2>

            <div class="card">
                <h3>Exportar Datos</h3>
                <p>Descargue todos los datos del registro en formato JSON.</p>
                <button class="primary" onclick="exportData()">Exportar Datos (JSON)</button>
            </div>

            <div class="card">
                <h3>Importar Datos</h3>
                <p>Cargue datos previamente exportados desde un archivo JSON.</p>
                <input type="file" id="import-file" accept=".json">
                <button class="primary" onclick="importData()">Importar Datos (JSON)</button>
            </div>

            <div class="card">
                <h3>Borrar Todos los Datos</h3>
                <p class="warning">‚ö†Ô∏è Esta acci√≥n eliminar√° todos los datos de forma permanente. Aseg√∫rese de exportar sus datos primero.</p>
                <button class="danger" onclick="clearAllData()">Borrar Todos los Datos</button>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="config" class="section">
            <h2>Ajuste de Par√°metros</h2>

            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h3>Par√°metros de C√°lculo</h3>
                    <button id="config-edit-btn" class="primary" onclick="toggleConfigEdit()">Editar</button>
                </div>

                <!-- Read-only view -->
                <div id="config-view">
                    <p><strong>Tarifa de Mano de Obra:</strong> <span id="view-labor-rate">$150.00 MXN/hora</span></p>
                    <p style="margin-left: 1.5rem; font-size: 0.9rem; color: #666; margin-bottom: 1rem;">
                        Costo por hora de trabajo directo en la producci√≥n
                    </p>
                    <p><strong>Multiplicador de Margen de Ganancia:</strong> <span id="view-margin">3.0x</span></p>
                    <p style="margin-left: 1.5rem; font-size: 0.9rem; color: #666; margin-bottom: 1rem;">
                        Precio Recomendado = CPC √ó este multiplicador (ej: 3 = margen de 200%)
                    </p>
                    <p style="margin-top: 1.5rem; padding: 1rem; background: #f5f5f5; border-left: 4px solid var(--color-molina-red); font-size: 0.9rem; color: #666;">
                        <strong>Nota:</strong> Los costos de renta, salarios y servicios deben registrarse en la secci√≥n de Transacciones.
                    </p>
                </div>

                <!-- Edit form (hidden by default) -->
                <form id="config-form" style="display: none;">
                    <div class="form-group">
                        <label for="config-labor-rate">Tarifa de Mano de Obra (MXN/hora):</label>
                        <input type="number" id="config-labor-rate" step="0.01" required>
                        <small>Costo por hora de trabajo directo en la producci√≥n</small>
                    </div>
                    <div class="form-group">
                        <label for="config-margin">Multiplicador de Margen de Ganancia:</label>
                        <input type="number" id="config-margin" step="0.1" min="1" required>
                        <small>Precio Recomendado = CPC √ó este multiplicador (ej: 3 = margen de 200%)</small>
                    </div>
                    <div style="display: flex; gap: 1rem;">
                        <button type="submit" class="primary">Guardar Cambios</button>
                        <button type="button" class="secondary" onclick="toggleConfigEdit()">Cancelar</button>
                    </div>
                </form>
            </div>

            <!-- GitHub Sync Card -->
            <div class="card">
                <h3>Sincronizaci√≥n con GitHub</h3>
                <p>Sincronice sus datos con GitHub para acceder desde m√∫ltiples dispositivos.</p>

                <!-- GitHub Token Section -->
                <div class="form-group" style="margin-top: 1.5rem;">
                    <label for="github-token">GitHub Personal Access Token:</label>
                    <input type="password" id="github-token" placeholder="ghp_...">
                    <small>
                        <a href="https://github.com/settings/tokens/new?description=Molina%20Sync&scopes=repo" target="_blank">Crear nuevo token</a>
                        con permisos de "repo"
                    </small>
                </div>

                <button type="button" class="primary" onclick="saveGitHubToken()">Guardar Token</button>

                <!-- Sync Controls -->
                <div id="sync-controls" style="margin-top: 2rem; display: none;">
                    <div style="display: flex; gap: 1rem; align-items: center; margin-bottom: 1rem;">
                        <button type="button" class="primary" onclick="syncToGitHub()">
                            <span id="sync-btn-text">Sincronizar Ahora</span>
                        </button>
                        <span id="sync-status" style="font-size: 0.9rem; color: #666;"></span>
                    </div>

                    <p style="font-size: 0.9rem; color: #666;">
                        <strong>√öltima sincronizaci√≥n:</strong> <span id="last-sync-time">Nunca</span>
                    </p>

                    <p style="margin-top: 1rem; padding: 1rem; background: #f5f5f5; border-left: 4px solid var(--color-molina-red); font-size: 0.9rem;">
                        <strong>Nota:</strong> Los datos se guardan autom√°ticamente en localStorage y se pueden sincronizar manualmente con GitHub cuando lo desee.
                    </p>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2023 Molina Cerveza Artesanal | Registro de Cervecer√≠a</p>
        </div>
    </footer>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- Authentication Overlay -->
    <div id="auth-overlay">
        <!-- Beer Bubbles Background -->
        <div class="beer-bubbles">
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
            <div class="bubble"></div>
        </div>

        <div id="auth-container">
            <!-- Logo -->
            <div class="auth-logo">
                <img src="assets/logo-molina.png" alt="Molina Logo" style="height: 220px; width: auto;">
            </div>

            <!-- Error Message -->
            <div id="auth-error" class="auth-error"></div>

            <!-- Step 1: Password -->
            <div id="auth-step-1" class="auth-step">
                <h2>üîê Autenticaci√≥n Requerida</h2>
                <p class="auth-description">Ingresa la contrase√±a para acceder al sistema</p>

                <form id="auth-password-form">
                    <div class="auth-input-group">
                        <label for="auth-password">Contrase√±a</label>
                        <input type="password" id="auth-password" required autocomplete="current-password" placeholder="Ingresa tu contrase√±a">
                    </div>
                    <button type="submit" class="auth-submit-btn">Continuar</button>
                </form>
            </div>

            <!-- Step 2: GitHub PAT -->
            <div id="auth-step-2" class="auth-step" style="display: none;">
                <h2>üîó Configurar GitHub Sync</h2>
                <p class="auth-description">Esta aplicaci√≥n requiere sincronizaci√≥n con GitHub para funcionar</p>

                <form id="auth-github-form">
                    <div class="auth-input-group">
                        <label for="github-repo">Repositorio de GitHub</label>
                        <select id="github-repo" required>
                            <option value="">Selecciona un repositorio</option>
                            <option value="dorianguzman/cerveza-molina">dorianguzman/cerveza-molina</option>
                            <option value="FrdMolina/cerveza-molina">FrdMolina/cerveza-molina</option>
                        </select>
                    </div>

                    <div class="auth-input-group">
                        <label for="github-pat">Personal Access Token (PAT)</label>
                        <input type="password" id="github-pat" required placeholder="ghp_...">
                        <small><a href="https://github.com/settings/tokens" target="_blank" style="color: var(--color-amber-gold);">¬øC√≥mo crear un PAT?</a></small>
                    </div>

                    <button type="submit" class="auth-submit-btn">Conectar con GitHub</button>
                </form>
            </div>

            <!-- Info Footer -->
            <div class="auth-footer">
                <p>üîí Todos los datos se almacenan de forma segura en tu repositorio de GitHub</p>
                <p><a href="SETUP_AUTH.md" target="_blank" style="color: var(--color-amber-gold);">Ver gu√≠a de configuraci√≥n</a></p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/auth.js"></script>
    <script src="js/data.js"></script>
    <script src="js/github-sync.js"></script>
    <script src="js/calculations.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
